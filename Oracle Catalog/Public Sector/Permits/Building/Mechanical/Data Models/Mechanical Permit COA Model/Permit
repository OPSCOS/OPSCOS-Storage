SELECT
LNP_RECORD_KEY,
LNP_RECORD_ID,
ATTRIBUTE_CATEGORY,
PERSON_FIRST_NAME || ' ' || PERSON_LAST_NAME APPLICANT_NAME,
DESCRIPTION,

CASE EXTN_ATTRIBUTE_CHAR004 
	WHEN 'Residential' then 'Residential'
    else 'Other / Commercial'
END AS OCCUPANCY_TYPE,

case EXTN_ATTRIBUTE_CHAR051					
 WHEN 'HVAC' THEN 'HVAC'
 WHEN 'GAS' THEN 'Gas Piping'
 WHEN 'HOOD' THEN 'Commercial Kitchen Exhaust Hood'
 when 'Tanks' Then 'Tanks LP / OIL'
 
 else 'Wood / Pellet Stove / Inserts'

end as MECHANICAL_PERMIT_TYPE,


--CURRENT_DATE

 CASE 
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 1 THEN 'January'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 2 THEN 'February'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 3 THEN 'March'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 4 THEN 'April'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 5 THEN 'May'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 6 THEN 'June'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 7 THEN 'July'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 8 THEN 'August'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 9 THEN 'September'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 10 THEN 'October'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 11 THEN 'November'
        WHEN EXTRACT(MONTH FROM CURRENT_DATE) = 12 THEN 'December'
        ELSE NULL 
    END || ' ' ||
    EXTRACT(DAY FROM CURRENT_DATE) || ', ' ||
    EXTRACT(YEAR FROM CURRENT_DATE) AS CURRENT_DATE



FROM PSC_LNP_RECORD
WHERE LNP_RECORD_ID = :P_LNP_RECORD_ID
ORDER BY CREATION_DATE DESC
