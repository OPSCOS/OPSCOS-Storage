SELECT
LNP_RECORD_KEY,
LNP_RECORD_ID,
PERSON_FIRST_NAME ||' '|| PERSON_LAST_NAME AS APPLICANT_NAME,
EXTN_ATTRIBUTE_CHAR220 AS ESTABLISHMENT_NAME,

CASE 
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 1 THEN 'January'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 2 THEN 'February'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 3 THEN 'March'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 4 THEN 'April'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 5 THEN 'May'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 6 THEN 'June'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 7 THEN 'July'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 8 THEN 'August'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 9 THEN 'September'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 10 THEN 'October'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 11 THEN 'November'
        WHEN EXTRACT(MONTH FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 12 THEN 'December'
        ELSE NULL
    END || ' ' || EXTRACT(DAY FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') 
    || ', ' || EXTRACT(YEAR FROM CAST(CURRENT_DATE AS TIMESTAMP) AT TIME ZONE 'EST') AS CURRENT_DATE,


CASE 
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 1 THEN 'January'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 2 THEN 'February'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 3 THEN 'March'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 4 THEN 'April'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 5 THEN 'May'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 6 THEN 'June'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 7 THEN 'July'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 8 THEN 'August'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 9 THEN 'September'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 10 THEN 'October'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 11 THEN 'November'
        WHEN EXTRACT(MONTH FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') = 12 THEN 'December'
        ELSE NULL
    END || ' ' || EXTRACT(DAY FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') 
    || ', ' || EXTRACT(YEAR FROM CAST(ISSUE_DATE AS TIMESTAMP) AT TIME ZONE 'EST') AS ISSUE_DATE

FROM PSC_LNP_RECORD
WHERE LNP_RECORD_ID = :P_LNP_RECORD_ID
