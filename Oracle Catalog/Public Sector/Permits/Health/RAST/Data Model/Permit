SELECT
    /* SECTION A */
    A.LNP_RECORD_KEY,
    A.LNP_RECORD_ID,
    A.ATTRIBUTE_CATEGORY,
    A.PERSON_FIRST_NAME || ' ' || A.PERSON_LAST_NAME AS APPLICANT_NAME, 
    A.EXTN_ATTRIBUTE_CHAR004 AS COMPANY_NAME, 
    A.EXTN_ATTRIBUTE_CHAR006 AS TRUCK_STORAGE_LOCATION,
    A.EXTN_ATTRIBUTE_NUMBER007 AS NUM_OF_TRUCKS,

    /* Dates and Times from Section A */
    
    ---ISSUE DATE 

 CASE 
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 1 THEN 'January'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 2 THEN 'February'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 3 THEN 'March'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 4 THEN 'April'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 5 THEN 'May'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 6 THEN 'June'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 7 THEN 'July'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 8 THEN 'August'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 9 THEN 'September'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 10 THEN 'October'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 11 THEN 'November'
        WHEN EXTRACT(MONTH FROM A.ISSUE_DATE) = 12 THEN 'December'
        ELSE NULL 
    END || ' ' ||
    EXTRACT(DAY FROM A.ISSUE_DATE) || ', ' ||
    EXTRACT(YEAR FROM A.ISSUE_DATE) AS ISSUE_DATE,
    
   
    'December 31, ' || EXTRACT(YEAR FROM A.EXPIRATION_DATE) AS EXPIRATION_DATE,

    /* SECTION B */
   TO_CHAR(SUM(DISTINCT B.FEE_AMOUNT), 'L9G999G999G999D99') AS FEES_PAID, 

    /* SECTION C */
    C.EXTN_ATTRIBUTE_CHAR004 AS CT_REGISTRATION_NUM,
    C.EXTN_ATTRIBUTE_CHAR007 AS DUMP_PERMIT_NUM,
    C.EXTN_ATTRIBUTE_CHAR006 AS LICENSE_PLATE_NUM

FROM PSC_LNP_RECORD A
INNER JOIN PSC_LNP_FEE_RECORD B ON A.LNP_RECORD_KEY = B.LNP_RECORD_KEY
INNER JOIN PSC_TS_GRID_RECORD C ON A.LNP_RECORD_KEY = C.EXTN_ATTRIBUTE_NUMBER001

WHERE A.LNP_RECORD_KEY = :P_LNP_RECORD_KEY
AND C.ATTRIBUTE_CATEGORY = 'LIC1RefuseTrucks1g1_c'
GROUP BY 
    A.LNP_RECORD_KEY,
    A.LNP_RECORD_ID,
    A.ATTRIBUTE_CATEGORY,
    A.PERSON_FIRST_NAME,
    A.PERSON_LAST_NAME, 
    A.EXTN_ATTRIBUTE_CHAR004, 
    A.EXTN_ATTRIBUTE_CHAR006,
    A.EXTN_ATTRIBUTE_NUMBER007,
    A.ISSUE_DATE,
    A.EXPIRATION_DATE,
    C.EXTN_ATTRIBUTE_CHAR004,
    C.EXTN_ATTRIBUTE_CHAR007,
    C.EXTN_ATTRIBUTE_CHAR006
