SELECT
LNP_RECORD_KEY,
LNP_RECORD_ID,
ATTRIBUTE_CATEGORY,
PERSON_FIRST_NAME || ' ' || PERSON_LAST_NAME APPLICANT_NAME, 
EXTN_ATTRIBUTE_CHAR015 AS ESTABLISHMENT_NAME,
/*CLASS TYPE FCL IS A ROMAN NUMERAL SO THERE WAS NO USE IN CASING IT*/

CASE EXTN_ATTRIBUTE_CHAR044		
	WHEN 'CLASS1' THEN 'Class I'
    WHEN 'CLASS2' THEN 'Class II'
    WHEN 'CLASS3' THEN 'Class III'
    WHEN 'CLASS4' THEN 'Class IV'
ELSE NULL 
END AS CLASS_TYPE,


/*THIS IS WHERE THE TRUCK IS STORED NOT WHERE IT'S GOING TO OPERATE FROM*/
EXTN_ATTRIBUTE_CHAR033 AS TRUCK_STORED,


CASE EXTN_ATTRIBUTE_CHAR016		
	WHEN 'Private' THEN EXTN_ATTRIBUTE_CHAR017		
    WHEN 'Public' THEN EXTN_ATTRIBUTE_CHAR018		
    WHEN 'Park' then 
        	CASE EXTN_ATTRIBUTE_CHAR020
            	WHEN 'BOP' THEN 'Boccuzzi Park'
            	WHEN 'BP' THEN 'Barrett Park'
            	WHEN 'CHP' THEN 'Chestnut Hill Park'
            	WHEN 'CIP' THEN 'Cove Island Park'
            	WHEN 'CMP' THEN 'Czescik Marina Park'
            	WHEN 'CP' THEN 'Cummings Park'
            	WHEN 'HP' THEN 'Harbor Point Commons Park'
            	WHEN 'JP' THEN 'Jackie Robinson Park'
            	WHEN 'LP' THEN 'Lione Park'
            	WHEN 'MJP' THEN 'Michael J. Drotar Park'
            	WHEN 'MRP' THEN 'Mill River Park'
            	WHEN 'SP' THEN 'Scalzi Park'
            	WHEN 'VP' THEN 'Veteran''s Park'  
    		ELSE NULL
            END
    WHEN 'Other' THEN EXTN_ATTRIBUTE_CHAR019		
	ELSE NULL
END AS VENDING_LOCATION,

CASE EXTN_ATTRIBUTE_CHAR021		
	WHEN 'MFT' THEN 'MOBILE FOOD TRUCK'
    WHEN 'MPC' THEN 'MOBILE PUSH CART'
ELSE NULL
END AS ESTABLISHMENT_TYPE, 

'January 1, ' || EXTRACT(YEAR FROM ISSUE_DATE) AS ISSUE_DATE,
'December 31, ' || EXTRACT(YEAR FROM EXPIRATION_DATE) AS EXPIRATION_DATE



FROM PSC_LNP_RECORD
WHERE LNP_RECORD_KEY = :P_LNP_RECORD_KEY
ORDER BY CREATION_DATE DESC
