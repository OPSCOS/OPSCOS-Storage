SELECT 
    A.LNP_RECORD_KEY,
    A.LNP_RECORD_ID,
    A.ATTRIBUTE_CATEGORY,
    A.PERSON_FIRST_NAME || ' ' || A.PERSON_LAST_NAME AS APPLICANT_NAME,

    --- EVENT NAME
    CASE 
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'Organizer' THEN A.EXTN_ATTRIBUTE_CHAR035        
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN A.EXTN_ATTRIBUTE_CHAR012        
        ELSE NULL 
    END AS EVENT_NAME,

    /* CLASS TYPE */
    CASE A.EXTN_ATTRIBUTE_CHAR029        
        WHEN 'Class1' THEN 'Class Type | Class I'
        WHEN 'Class2' THEN 'Class Type | Class II'
        WHEN 'Class3' THEN 'Class Type | Class III'
        WHEN 'Class4' THEN 'Class Type | Class IV'
        ELSE NULL
    END AS CLASS_TYPE,

    --- DATES AND TIMES 
    --- TEMP EVENT START DATE 
    CASE 
        WHEN A.EXTN_ATTRIBUTE_CHAR034= 'Organizer' THEN 
            CASE 
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 6 THEN 'June'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 7 THEN 'July'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 8 THEN 'August'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 9 THEN 'September'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 10 THEN 'October'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 11 THEN 'November'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) = 12 THEN 'December'
                ELSE NULL 
            END || ' ' ||
            EXTRACT(DAY FROM A.EXTN_ATTRIBUTE_TIMESTAMP005) || ', ' ||
            EXTRACT(YEAR FROM A.EXTN_ATTRIBUTE_TIMESTAMP005)
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN 
            CASE 
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 6 THEN 'June'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 7 THEN 'July'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 8 THEN 'August'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 9 THEN 'September'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 10 THEN 'October'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 11 THEN 'November'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) = 12 THEN 'December'
                ELSE NULL 
            END || ' ' ||
            EXTRACT(DAY FROM A.EXTN_ATTRIBUTE_TIMESTAMP001) || ', ' ||
            EXTRACT(YEAR FROM A.EXTN_ATTRIBUTE_TIMESTAMP001)
    ELSE NULL 
    END AS EVENT_START_DATE,

    --- TEMP EVENT END DATE 
    CASE 
        WHEN A.EXTN_ATTRIBUTE_CHAR034= 'Organizer' THEN 
            CASE 
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 6 THEN 'June'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 7 THEN 'July'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 8 THEN 'August'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 9 THEN 'September'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 10 THEN 'October'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 11 THEN 'November'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) = 12 THEN 'December'
                ELSE NULL 
            END || ' ' ||
            EXTRACT(DAY FROM A.EXTN_ATTRIBUTE_TIMESTAMP004) || ', ' ||
            EXTRACT(YEAR FROM A.EXTN_ATTRIBUTE_TIMESTAMP004)
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN 
            CASE 
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 1 THEN 'January'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 2 THEN 'February'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 3 THEN 'March'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 4 THEN 'April'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 5 THEN 'May'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 6 THEN 'June'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 7 THEN 'July'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 8 THEN 'August'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 9 THEN 'September'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 10 THEN 'October'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 11 THEN 'November'
                WHEN EXTRACT(MONTH FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) = 12 THEN 'December'
                ELSE NULL 
            END || ' ' ||
            EXTRACT(DAY FROM A.EXTN_ATTRIBUTE_TIMESTAMP002) || ', ' ||
            EXTRACT(YEAR FROM A.EXTN_ATTRIBUTE_TIMESTAMP002)
    ELSE NULL 
    END AS EVENT_END_DATE,

    --- PARCEL ADDRESS INNER JOIN B 
    CASE 
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'Organizer' THEN B.ADDRESS1 ||' '|| B.CITY ||','|| B.STATE ||' '|| B.POSTAL_CODE
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN A.EXTN_ATTRIBUTE_CHAR014    
        ELSE NULL
    END AS LOCATION_OF_PARTICIPATION,

    CASE            
        WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN CONCAT('DBA: ', A.EXTN_ATTRIBUTE_CHAR059)
        ELSE NULL
    END AS DBA,
  
  
CASE 
    WHEN A.EXTN_ATTRIBUTE_CHAR034 = 'VendorParticipant' THEN 
        CONCAT ('Day Participating: ',
        CASE 
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 1 THEN 'January'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 2 THEN 'February'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 3 THEN 'March'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 4 THEN 'April'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 5 THEN 'May'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 6 THEN 'June'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 7 THEN 'July'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 8 THEN 'August'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 9 THEN 'September'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 10 THEN 'October'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 11 THEN 'November'
            WHEN EXTRACT(MONTH FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) = 12 THEN 'December'
            ELSE NULL 
        END || ' ' ||
        EXTRACT(DAY FROM C.EXTN_ATTRIBUTE_TIMESTAMP001) || ', ' ||
        EXTRACT(YEAR FROM C.EXTN_ATTRIBUTE_TIMESTAMP001))
    ELSE NULL 
END AS DAYS_PARTICIPATING


FROM PSC_LNP_RECORD A
INNER JOIN PSC_LNP_PARCEL_ADDRESS B ON A.LNP_RECORD_KEY = B.LNP_RECORD_KEY
INNER JOIN PSC_TS_GRID_RECORD C ON A.LNP_RECORD_KEY = C.EXTN_ATTRIBUTE_NUMBER001

WHERE A.LNP_RECORD_ID = :P_LNP_RECORD_ID
AND C.ATTRIBUTE_CATEGORY = 'LNP1TempFood1g5_c'
ORDER BY A.CREATION_DATE DESC
