SELECT
    /* Section: General */   
    /* This section includes general attributes that are also found in most other building permits */ 
    LNP_RECORD_KEY,
    LNP_RECORD_ID,
    ATTRIBUTE_CATEGORY,
    PERSON_FIRST_NAME || ' ' || PERSON_LAST_NAME AS APPLICANT_NAME,
    NVL(PHONE_AREA_CODE || '' || PHONE_NUMBER, '') AS PHONE_NUM,
    ADDRESS1 ||' '|| CITY ||' '|| STATE ||' '|| POSTAL_CODE AS APPLICANT_ADDRESS,
    EMAIL_ADDRESS1 AS APPLICANT_EMAIL,
    
    /* THIS DOES NOT NEED A SUM FOR NOW BUT DISSCUSS WITH DEPARTMENT IF ANY OTHER ADDITIONS NEED TO BE INCLUDED IN THE CALCULATION BELOW */
    EXTN_ATTRIBUTE_NUMBER005 as COST_OF_WORK,
    EXTN_ATTRIBUTE_CHAR010 as CBDY_NUMBER, 
    EXTN_ATTRIBUTE_CHAR013 AS INSURER, 
    EXTN_ATTRIBUTE_CHAR014 AS INSURANCE_POLICY_NUMBER, 
  	DESCRIPTION,
    EXTN_ATTRIBUTE_CHAR027 AS CONTRACT_NUMBER, 
    EXTN_ATTRIBUTE_CHAR012 AS CT_CONTRACT_NUM_POSSIBLY,
    
    
    /* WORK DONE FOR CASE */
    
CASE EXTN_ATTRIBUTE_CHAR008	
	WHEN 'City' THEN 'City'
    WHEN 'GC' THEN 'General Contractor'
    WHEN 'PO' THEN 'Property Owner'
    WHEN 'State' THEN 'State'
    when 'UC' THEN 'Utility Company'
    else NULL
    END AS WORK_DONE_FOR, 
 
            
        
            
            
    /* Section: Dates and Times */           
    /* Includes the Issue Date and the Experation Date */        

            
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) ISSUE_DATE,
     
 
 /* EXCAVATION START AND END TIMES */
     
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) EXCAVATION_START_DATE,
     
     
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) EXCAVATION_END_DATE,
     

CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP005 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) INSURANCE_EXPIRATION_DATE,
     
 /*DEPARTEMENTAL REQUIRMENTS*/
 
 EXTN_ATTRIBUTE_CHAR031 AS PERMITTED_WORK_HOURS,
 EXTN_ATTRIBUTE_CHAR033 AS PERMIT_REQUIRMENTS,
 EXTN_ATTRIBUTE_CHAR032	AS SPECIAL_REQUIRMENTS,
 EXTN_ATTRIBUTE_CHAR029	AS TRAFFIC_CONDITIONS,
 EXTN_ATTRIBUTE_CHAR030	AS WPCA_CONDITIONS,
 EXTN_ATTRIBUTE_CHAR031	AS ENG_SUPERVISOR_CONDITIONS,
 EXTN_ATTRIBUTE_CHAR035 AS SUPERVISORS_SIGNATURE


FROM PSC_LNP_RECORD
WHERE LNP_RECORD_ID = :P_LNP_RECORD_ID
ORDER BY CREATION_DATE DESC
