SELECT
    /* Section: General */   
    /* This section includes general attributes that are also found in most other building permits */ 
    LNP_RECORD_KEY,
    LNP_RECORD_ID,
    ATTRIBUTE_CATEGORY,
    PERSON_FIRST_NAME || ' ' || PERSON_LAST_NAME AS APPLICANT_NAME,
    NVL(PHONE_AREA_CODE || '' || PHONE_NUMBER, '') AS PHONE_NUM,
    ADDRESS1 ||' '|| CITY ||' '|| STATE ||' '|| POSTAL_CODE AS APPLICANT_ADDRESS,
    EMAIL_ADDRESS1 AS APPLICANT_EMAIL,
    DESCRIPTION,
    
    /* THIS DOES NOT NEED A SUM FOR NOW BUT DISSCUSS WITH DEPARTMENT IF ANY OTHER ADDITIONS NEED TO BE INCLUDED IN THE CALCULATION BELOW */
    EXTN_ATTRIBUTE_CHAR011 AS INSURER, 
    EXTN_ATTRIBUTE_CHAR012 AS INSURANCE_POLICY_NUMBER, 
    EXTN_ATTRIBUTE_CHAR004 AS COMPANY_NAME,
    
    /* WORK DONE FOR CASE */
    
CASE EXTN_ATTRIBUTE_CHAR006				
	WHEN 'City' THEN 'City'
    WHEN 'PropertyOwner' THEN 'Property Owner'
    WHEN 'State' THEN 'State'
    WHEN 'Utility' THEN 'State'
    when 'UC' THEN 'Utility'
    ELSE CONCAT('Other - ',EXTN_ATTRIBUTE_CHAR007)
END AS WORK_DONE_FOR, 
 
            
        
            
            
    /* Section: Dates and Times */           
       
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(ISSUE_DATE AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) ISSUE_DATE,
     
     
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP001 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) OBSTRUCTION_START_DATE,
     
     
CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP002 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) OBSTRUCTION_END_DATE,
         
     
  CASE WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 1 THEN 'January'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 2 THEN 'February'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 3 THEN 'March'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 4 THEN 'April'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 5 THEN 'May'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 6 THEN 'June'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 7 THEN 'July'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 8 THEN 'August'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 9 THEN 'September'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 10 THEN 'October'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 11 THEN 'November'
	 WHEN EXTRACT(MONTH FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) = 12 THEN 'December'
	 ELSE NULL END 
	 || ' ' || EXTRACT(DAY FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) 
	 || ', ' || EXTRACT(YEAR FROM CAST(CAST(EXTN_ATTRIBUTE_TIMESTAMP003 AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'EST' AS TIMESTAMP)) INSURANCE_EXPIRATION_DATE,   
     
 /*DEPARTEMENTAL REQUIRMENTS*/
 EXTN_ATTRIBUTE_CHAR030 AS PERMIT_REQUIRMENTS,
 EXTN_ATTRIBUTE_CHAR032 AS SPECIAL_REQUIRMENTS,
 EXTN_ATTRIBUTE_CHAR033	AS TRAFFIC_CONDITIONS
 
 



FROM PSC_LNP_RECORD
WHERE LNP_RECORD_ID = :P_LNP_RECORD_ID
ORDER BY CREATION_DATE DESC
